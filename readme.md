# Directum

Скрипты для администрирования [Directum](http://www.directum.ru/).

## Запуск

Все утилиты запускаются с параметром сервер/база,
например `ca.bat Directum/Directum`.
Значения по умолчанию можно вписать в третью строку скрипта.

### add

Интерактивная настройка пользователей Directum по данным из AD.

### block

Блокирование пользователей Directum, которые неактивны в AD.

### ca

Копирование сертификатов пользователей из AD в Directum.

Скрипт запускает Directum (через SBLauncher) и снова выполняет себя же
из под него. В Directum должен быть установлен сценарий
[ca_bat](src/ca/ca_bat.isb).

### install

Установка клиента Directum - запуск Client.exe с тщательно подобранными параметрами ;-)

Берёт параметры из командной строки (server & db)
и лежащего рядом с ним install.yml ([пример](src/install/install.yml))

Проверяет наличие прав локального администратора.

Удобно сделать к нему ярлык `%comspec% /c path/to/install.bat`,
позволяет запускать его от произвольного пользователя.

### photo

Копирует все фотографии пользователей из AD (которые найдёт)
в соответствующие персоны Directum.

## Разработка

0. Установить [Node.js](https://nodejs.org/)

1. Установить зависимости `npm install`

2. Запуск с автоматической перестройкой `npm test`

3. Создание окончательных версий `npm start`

Используйте меню Far Manager.

  - Исходные коды скриптов расположены в папке [src](src).

  - Механизм сборки конфигурируется в папке [webpack](webpack).

  - Скомпилированные скрипты размещены в папку [dist](dist).

## Кодировка

Исходные коды строго в UTF-8.
Готовые скрипты для Windows Script Host (JScript) должны быть в кодировке
Windows-1251.
